// ==UserScript==
// @name MTDeck for OTD
// @version 2.1.0
// @author mkizka, kdroidwin, and fronoske
// @description TweetDeckをスマホアプリのように使えるようにするUserScript (OTD対応版) mod by fronoske
// @homepage https://github.com/fronoske/MTDeck_for_OTD
// @match https://twitter.com/i/tweetdeck
// ==/UserScript==
!function(){"use strict";const e={en:{extensionDescription:{message:"A browser extension to customize TweetDeck with OTD for mobile"},configTitle:{message:"Preference"},configSaveLabel:{message:"Save and Reload"},configBackLabel:{message:"Close"},configLinksLabel:{message:"Bug/Feature Report"},configOptionBackAtMounted:{message:"Close notifications at startup"},configOptionNoAnimation:{message:"Disable animation"},configOptionHideImages:{message:"Hide image thumbnails on tweet"},configOptionHideEngagementCounts:{message:"Hide Reply,Retweet,Like counts on tweet"},configOptionLazyLoadImages:{message:"Lazy load image thumbnails on tweet"},configOptionMenuOpenRange:{message:"Range to open menu with swipe"},configOptionMobileFriendlyOnCol:{message:"Enable mobile friendly styles on columns"},configOptionShowAbsoluteTime:{message:"Show absolute time"},configOptionEnableSwipeNavMedia:{message:"Enable horizontal swipe to prev/next media"},configOptionEnableSwipeNavCol:{message:"Enable horizontal swipe to prev/next column"},configOptionShowExpander:{message:"Show 'Expand tweet' button"},configOptionEnableSwipeDownToCloseMedia:{message:"Enable swipe down to close media"},configOptionEnableTapToShowFullImage:{message:"Enable tap to show full-sized image"},configOptionShowInitialInColumnTab:{message:"Show initial of list (user) name in list (user) tab"}},ja:{extensionDescription:{message:"TweetDeck + OTD をスマホアプリのように使えるようにするアドオン"},configTitle:{message:"設定メニュー"},configSaveLabel:{message:"保存して再読み込み"},configBackLabel:{message:"戻る"},configLinksLabel:{message:"バグ報告/機能提案など"},configOptionBackAtMounted:{message:"起動直後に開いている通知などを閉じる"},configOptionNoAnimation:{message:"アニメーションの無効化"},configOptionHideImages:{message:"ツイートの画像サムネイルを非表示"},configOptionHideEngagementCounts:{message:"ツイートのリプライ、いいね、RT数を非表示"},configOptionLazyLoadImages:{message:"ツイートの画像サムネイルを遅延読み込み"},configOptionMenuOpenRange:{message:"左からのスワイプでメニューを開く範囲"},configOptionMobileFriendlyOnCol:{message:"カラム内にスマホ向けのスタイルを適用"},configOptionShowAbsoluteTime:{message:"絶対時刻を表示する"},configOptionEnableSwipeNavMedia:{message:"横スワイプで画像を切り替える"},configOptionEnableSwipeNavCol:{message:"横スワイプでカラムを移動する"},configOptionShowExpander:{message:"長文ツイートの場合に「Expand tweet」を表示する"},configOptionEnableSwipeDownToCloseMedia:{message:"下スワイプで画像を閉じる"},configOptionEnableTapToShowFullImage:{message:"画像のタップでフルサイズ表示する"},configOptionShowInitialInColumnTab:{message:"タブにリスト名とユーザー名の頭文字を表示する"}}},t=e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector("body");if(null==(null==t?void 0:t.firstElementChild))throw Error;return t.firstElementChild},n=e=>{document.querySelectorAll(e).forEach((e=>e.click()))},i=t=>{if("undefined"!=typeof chrome&&void 0!==chrome.i18n)return chrome.i18n.getMessage(t);const n=/ja/.test(window.navigator.language)?"ja":"en";return e[n][t].message||""},o=e=>{const t=document.createElement("style");t.setAttribute("type","text/css"),t.innerText=e,document.head.appendChild(t)};class a{constructor(){this.$container=null,this.$columnNavigator=null,this.isNoAnimation=!1}init(){this.$container=document.querySelector("#container"),this.$columnNavigator=document.querySelector("#column-navigator"),this.isNoAnimation=document.body.classList.contains("mtdeck-no-animation"),this.isNoAnimation&&(this.setNoAnimationJump(),this.setNoAnimationObserver())}scrollTo(e){const{left:t}=e.getBoundingClientRect(),n=this.isNoAnimation?"auto":"smooth";this.$container.scrollBy({left:t,behavior:n});this.$columnNavigator.querySelector(`li[data-column=${e.dataset.column}]`).scrollIntoView({behavior:n,inline:"nearest"})}setNoAnimationObserver(){new MutationObserver((()=>this.setNoAnimationJump())).observe(this.$columnNavigator,{childList:!0,attributes:!1,characterData:!1})}setNoAnimationJump(){this.$columnNavigator.querySelectorAll("li[data-column] a").forEach((e=>{(function(e){const n=t(e.outerHTML);return e.insertAdjacentElement("afterend",n),e.remove(),n})(e).addEventListener("click",(t=>{this.$container.querySelector(`section[data-column=${e.dataset.column}]`).scrollIntoView({inline:"nearest"})}))}))}}class s{static get isOpen(){return!document.body.classList.contains("mtdeck-close")}static open(){s.isOpen||document.body.classList.remove("mtdeck-close")}static close(){s.isOpen&&document.body.classList.add("mtdeck-close")}}class d{constructor(){this.activeQuery="",this.clickQuery=""}get exists(){return document.querySelectorAll(this.activeQuery).length>0}back(){n(this.clickQuery)}}class c extends d{constructor(){super(...arguments),this.activeQuery=".mtdeck-config.is-open",this.clickQuery="#mtdeck-config-back"}}class l extends d{constructor(){super(...arguments),this.activeQuery=".app-content.is-open",this.clickQuery=".js-drawer-close"}}class m extends d{constructor(){super(...arguments),this.activeQuery="#open-modal .js-column-state-social-proof",this.clickQuery="#open-modal .js-tweet-social-proof-back"}}class r extends d{constructor(){super(...arguments),this.activeQuery="#open-modal .js-column-state-detail-view",this.clickQuery="#open-modal .js-column-back"}}class u extends d{constructor(){super(...arguments),this.activeQuery=".mdl .btn-back",this.clickQuery=".mdl .btn-back"}}class p extends d{constructor(){super(...arguments),this.activeQuery=".mdl .js-dismiss",this.clickQuery=".mdl .js-dismiss"}}class h extends d{constructor(){super(...arguments),this.activeQuery="#container .js-column-state-social-proof",this.clickQuery="#container .js-tweet-social-proof-back"}}class b extends d{constructor(){super(...arguments),this.activeQuery="#container .js-column-state-detail-view",this.clickQuery="#container .js-column-back"}}class g extends d{constructor(){super(...arguments),this.activeQuery=".is-options-open",this.clickQuery=".is-options-open .js-action-header-button"}}class f extends d{get exists(){return s.isOpen}back(){s.close()}}class y{constructor(){this.backables=[new c,new l,new m,new r,new u,new p,new h,new b,new g,new f]}back(){for(let e of this.backables)if(e.exists){e.back();break}}}class w{constructor(e){this.onTap=()=>{},this.onSwipeX=()=>{},this.onSwipeY=()=>{},this.start={x:0,y:0,time:0},this.end={x:0,y:0,time:0},e.addEventListener("click",(()=>this.onTap())),e.addEventListener("touchstart",(e=>{this.start={x:e.touches[0].screenX,y:e.touches[0].screenY,time:(new Date).getTime()}})),e.addEventListener("touchmove",(e=>{this.end={x:e.touches[0].screenX,y:e.touches[0].screenY,time:(new Date).getTime()}})),e.addEventListener("touchend",(e=>{if("X"===this.swipedAxis){const e=this.start.x<this.end.x?"right":"left";this.onSwipeX(this.start.x,e)}if("Y"===this.swipedAxis){const e=this.start.y<this.end.y?"down":"up";this.onSwipeY(this.start.y,e)}}))}get swipedAxis(){const e=this.end.x-this.start.x,t=this.end.y-this.start.y,n=this.end.time-this.start.time,i=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))/n;return Math.abs(e)>=10&&Math.abs(i)>=.3&&Math.abs(t/e)<=1?"X":Math.abs(t)>=10&&Math.abs(i)>=.3&&Math.abs(t/e)>1?"Y":""}}class k{constructor(){this.$el=null,this.items=[{label:i("configOptionBackAtMounted"),name:"mtdBackAtMounted",type:"checkbox",default:"true"},{label:i("configOptionNoAnimation"),name:"mtdNoAnimation",type:"checkbox",default:"false"},{label:i("configOptionHideImages"),name:"mtdHideImages",type:"checkbox",default:"false"},{label:i("configOptionHideEngagementCounts"),name:"mtdHideCounts",type:"checkbox",default:"false"},{label:i("configOptionLazyLoadImages"),name:"mtdLazyLoadImages",type:"checkbox",default:"false"},{label:i("configOptionMenuOpenRange"),name:"mtdMenuOpenRange",type:"number",default:"30"},{label:i("configOptionMobileFriendlyOnCol"),name:"mtdMobileStyleFriendly",type:"checkbox",default:"true"},{label:i("configOptionShowAbsoluteTime"),name:"mtdShowAbsoluteTime",type:"checkbox",default:"false"},{label:i("configOptionEnableSwipeNavMedia"),name:"mtdEnableSwipeNavMedia",type:"checkbox",default:"false"},{label:i("configOptionEnableSwipeNavCol"),name:"mtdEnableSwipeNavCol",type:"checkbox",default:"false"},{label:i("configOptionShowExpander"),name:"mtdShowExpander",type:"checkbox",default:"false"},{label:i("configOptionEnableSwipeDownToCloseMedia"),name:"mtdSwipeDownToCloseMedia",type:"checkbox",default:"false"},{label:i("configOptionEnableTapToShowFullImage"),name:"mtdTapToShowFullImage",type:"checkbox",default:"false"},{label:i("configOptionShowInitialInColumnTab"),name:"mtdShowInitialInColumnTab",type:"checkbox",default:"false"}]}getString(e){return localStorage.getItem(e).toString()}getNumber(e){return parseFloat(localStorage.getItem(e))}getBoolean(e){return"true"===localStorage.getItem(e)}open(){this.$el.classList.add("is-open")}close(){this.save(),this.$el.classList.remove("is-open")}isOpen(){return this.$el.classList.contains("is-open")}save(){document.querySelectorAll(".mtdeck-config-input").forEach((e=>{"checkbox"===e.type?localStorage.setItem(e.name,`${e.checked}`):localStorage.setItem(e.name,e.value)}))}saveDefault(){this.items.forEach((e=>{null===localStorage.getItem(e.name)&&localStorage.setItem(e.name,e.default)}))}createInfo(){this.$el.appendChild(t(`\n      <div class="mtdeck-config-item">\n        <p>MTDeck v2.1.0</p>\n        <p>${i("configLinksLabel")}:\n          <a href="https://github.com/fronoske/MTDeck_for_OTD" target="_blank">Github</a>\n          <a href="https://twitter.com/fronoske">Twitter</a>\n        </p>\n      </div>\n    `))}createFooter(){this.$el.appendChild(t(`\n      <div class="mtdeck-config-footer">\n        <button id="mtdeck-config-save">${i("configSaveLabel")}</button>\n        <button id="mtdeck-config-back">${i("configBackLabel")}</button>\n      </div>\n    `)),document.querySelector("#mtdeck-config-save").addEventListener("click",(()=>{this.save(),location.reload()})),document.querySelector("#mtdeck-config-back").addEventListener("click",(()=>{this.close()}))}createForm(){this.items.forEach((e=>{const n=t(`\n        <input class="mtdeck-config-input" type="${e.type}" name="${e.name}"/>\n      `);"checkbox"===e.type?n.defaultChecked=this.getBoolean(e.name):n.defaultValue=this.getString(e.name),this.$el.insertAdjacentElement("beforeend",t(`\n        <label class="mtdeck-config-item">\n          ${n.outerHTML}  \n          ${e.label}\n        </label>\n      `))}))}createSettingButton(){const e=document.querySelector(".js-app-settings"),n=t(e.outerHTML);n.dataset.action="mtdeckConfig",n.dataset.title="MTDeck Config",n.classList.add("mtdeck-config-button"),n.querySelector(".app-nav-link-text").insertAdjacentText("afterbegin","MTD"),e.parentElement.insertAdjacentElement("afterbegin",n),n.addEventListener("click",(e=>this.open()))}createConfigBase(){this.$el=t(`\n      <div class="mtdeck-config">\n        <h1 class="mtdeck-config-item">${i("configTitle")}</h1>\n      </div>\n    `),document.body.appendChild(this.$el)}init(){this.saveDefault(),this.createConfigBase(),this.createInfo(),this.createForm(),this.createFooter(),this.createSettingButton()}}class v{constructor(){this.$appContainer=document.querySelector("div.app-columns-container"),this.bodyClassList=document.body.classList}doCustomize(e){const t=this.bodyClassList.contains("mtdeck-show-absolute-time"),n=this.bodyClassList.contains("mtdeck-show-expander"),i=this.bodyClassList.contains("mtdeck-enable-swipe-col"),o=this.bodyClassList.contains("mtdeck-show-initial-in-col-tab");i&&this.enableSwipeNavCol(e);new MutationObserver((()=>{n&&(new x).addExpandTweetButton(),t&&(new S).updateTweetTimestamps()})).observe(this.$appContainer,{childList:!0,attributes:!1,characterData:!1,subtree:!0}),o&&this.showInitialInColumnTab()}showInitialInColumnTab(){const e=document.querySelectorAll("li.js-column-nav-menu-item"),t="position: absolute; left: 63%; bottom: 5%; font-size: medium; font-weight: bold;";e.forEach((e=>{var n,i;const o=e.querySelector("a.js-header-action > div.obj-left > i");if(null==o?void 0:o.classList.contains("icon-list")){const i=null===(n=e.querySelector("span.column-heading"))||void 0===n?void 0:n.textContent;if(null===i||""===i)return;const o=document.createElement("span");o.textContent=i[0],o.setAttribute("style",t),e.appendChild(o)}else if(null==o?void 0:o.classList.contains("icon-user")){const n=null===(i=e.querySelector("span.txt-mute"))||void 0===i?void 0:i.textContent;if(null===n||""===n)return;const o=document.createElement("span");o.textContent=n[1],o.setAttribute("style",t),e.appendChild(o)}}))}enableSwipeNavCol(e){new w(this.$appContainer).onSwipeX=(t,n)=>{e.update();const i=document.querySelectorAll("a.column-nav-link");i.forEach((e=>e.classList.remove("is-selected")));let o="left"==n?e.columnIndex+1:e.columnIndex-1;o=Math.min(i.length-1,Math.max(0,o)),i[o].click(),i[o].classList.add("is-selected")}}}class x{addExpandTweetButton(){document.querySelectorAll("article.js-stream-item").forEach((e=>{var t,n,i;const o=e.querySelector(".js-tweet-text"),a=null===(t=e.querySelector("span.tweet-action[href]"))||void 0===t?void 0:t.getAttribute("href");if(null!==o&&null!==a){const t=Array.from(o.childNodes).reverse().find((e=>e.nodeType==Node.TEXT_NODE));if((null===(n=null==t?void 0:t.textContent)||void 0===n?void 0:n.endsWith("…"))&&!(null===(i=null==t?void 0:t.textContent)||void 0===i?void 0:i.endsWith("……"))){const t=e.getAttribute("data-tweet-id");o.innerHTML+=`&nbsp;<a class="expand-tweet" href="${a}" onclick="expandTweet(event, '${t}')">Expand tweet</a>`}}}))}}class S{updateTweetTimestamps(){var e,t,n;const i=document.querySelectorAll("time.tweet-timestamp:not([data-msecdeck=done])");if(i.length)for(const o of i){o.dataset.msecdeck="done";const i=o.firstElementChild;if(null===i||null===i.textContent)continue;const a=Number((null===(e=i.getAttribute("href"))||void 0===e?void 0:e.split("/")[5])||o.dataset.time||(null===(t=i.textContent)||void 0===t?void 0:t.replace(/(am|pm)\s·/," $1")));if(0!=a){const e=this.formatTime(this.getDateFromSnowflake(a));if(i.textContent.length>6)i.textContent=e;else{const t=document.createElement("span");t.classList.add("tweet-timestamp","txt-mute","flex-shrink--0","txt-size-variable--12","no-wrap","mtdeck-absolute-time"),t.textContent=`${e} -`,null===(n=o.parentElement)||void 0===n||n.insertBefore(t,o)}}const s=o.closest("article[data-key][data-tweet-id");null!==s&&s.getAttribute("data-key")!=s.getAttribute("data-tweet-id")&&this.showRtTimestamp(s)}}showRtTimestamp(e){const t=e.getAttribute("data-key"),n=e.getAttribute("data-tweet-id");if(t&&/^[0-9]+$/.test(t)&&t!=n){const n=this.getDateFromSnowflake(Number(t)),i=e.querySelector("div.nbfc");n&&i&&i.textContent&&(i.textContent=i.textContent.replace(/Retweeted +/,`Retweeted at ${this.formatTime(n)}`))}}getDateFromSnowflake(e){const t=Math.floor(e/4194304)+1288834974657;return new Date(t)}formatTime(e,t=!0){const n=t?`(${["日","月","火","水","木","金","土"][e.getDay()]}) `:"";var i,o;return`${(new Date).getFullYear()!=e.getFullYear()?`${e.getFullYear()}/`:""}${`${e.getMonth()+1}/${e.getDate()}${n}`} ${`${e.getHours()}:${i=e.getMinutes(),o=2,i.toString().padStart(o,"0")}`}`}}class C{constructor(){this.$mediaPanel=document.querySelector("div#open-modal"),this.bodyClassList=document.body.classList}doCustomize(){const e=this.bodyClassList.contains("mtdeck-enable-swipe-media"),t=this.bodyClassList.contains("mtdeck-enable-swipe-down-to-close-media"),n=this.bodyClassList.contains("mtdeck-enable-tap-to-show-full-image");e&&this.enableSwipeNavMedia(),t&&(o("div.full-media-box {\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          background: rgba(100, 100, 100, 0.8);\n          z-index: 99999;\n          /* 縦方向の中央寄せ */\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n        /* 画像は横幅を max に */\n        img.full-image {\n          width: 100%;\n          height: auto;\n        }\n        img.full-image-max {\n        }\n        "),this.enableSwipeDownToCloseMedia()),n&&this.enableShowFullImage()}enableSwipeNavMedia(){new w(this.$mediaPanel).onSwipeX=(e,t)=>{var n,i;switch(t){case"left":null===(n=document.querySelector("a.js-media-gallery-next"))||void 0===n||n.click();break;case"right":null===(i=document.querySelector("a.js-media-gallery-prev"))||void 0===i||i.click()}}}enableSwipeDownToCloseMedia(){new w(this.$mediaPanel).onSwipeY=(e,t)=>{var n,i;switch(console.log(t),t){case"up":const e=null===(n=document.querySelector("img.media-img"))||void 0===n?void 0:n.parentElement;this.showFullImageOnTap(e,"full");break;case"down":null===(i=document.querySelector("a.mdl-dismiss"))||void 0===i||i.click()}}}enableShowFullImage(){new MutationObserver((e=>{for(const t of e){Array.from(t.removedNodes).some((e=>e.nodeType==Node.ELEMENT_NODE&&e.classList.contains("js-mediatable")))&&document.querySelectorAll("div.full-media-box").forEach((e=>e.remove())),t.addedNodes.forEach((e=>{if(e.nodeType!=Node.ELEMENT_NODE||!e.classList.contains("js-media-preview-container"))return;const t=e.querySelectorAll("a.js-media-image-link");t&&t.forEach((e=>{e.addEventListener("click",(e=>{this.showFullImageOnTap(e.currentTarget,"normal")}))}))}))}})).observe(this.$mediaPanel,{childList:!0,attributes:!1,characterData:!1,subtree:!0})}showFullImageOnTap(e,t){e.removeAttribute("href");const n=e.querySelector("img.media-img"),i=null==n?void 0:n.getAttribute("src"),o=document.createElement("img");o.setAttribute("src",i),o.setAttribute("class","full"==t?"full-image-max":"full-image");const a=document.createElement("div");a.setAttribute("class","full-media-box"),a.appendChild(o),this.$mediaPanel.appendChild(a),a.addEventListener("click",(e=>{var t;e.stopPropagation(),null===(t=e.currentTarget)||void 0===t||t.remove()})),a.addEventListener("touchstart",(e=>{e.stopPropagation()})),a.addEventListener("touchend",(e=>{e.stopPropagation()})),a.addEventListener("touchmove",(e=>{e.stopPropagation()}))}}o('@charset "UTF-8";\nbody.mtdeck {\n  /* カラム番号を表示しないようにする */\n  /* ヘッダー画像をもう少し暗くする */\n}\nbody.mtdeck button[data-drawer=compose] {\n  z-index: 1;\n  position: fixed !important;\n  right: 20px;\n  bottom: 60px;\n  width: 4rem !important;\n  height: 4rem !important;\n  filter: drop-shadow(5px 5px 5px rgba(0, 0, 0, 0.7));\n}\nbody.mtdeck .app-columns {\n  padding: 0 0 50px 0 !important;\n}\nbody.mtdeck .app-content {\n  left: 0 !important;\n}\nbody.mtdeck .app-columns-container {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\nbody.mtdeck section.column,\nbody.mtdeck .js-modal-panel,\nbody.mtdeck .prf-header,\nbody.mtdeck .prf-header-inner-overlay,\nbody.mtdeck .social-proof-container {\n  width: 100% !important;\n}\nbody.mtdeck .overlay:before {\n  margin-right: -5px;\n}\nbody.mtdeck .mdl {\n  width: 100% !important;\n  overflow-x: hidden;\n}\nbody.mtdeck .mdl .mdl-inner {\n  padding: 5px;\n}\nbody.mtdeck .mdl .mdl-inner .js-right-column {\n  overflow-x: hidden;\n}\nbody.mtdeck .mdl .mdl-inner .mdl-column:first-child {\n  display: none;\n}\nbody.mtdeck .mdl .mdl-inner .mdl-column:not(:first-child) {\n  width: 100% !important;\n}\nbody.mtdeck .mdl .mdl-dismiss {\n  right: 10px !important;\n}\nbody.mtdeck .med-tweet {\n  width: 100% !important;\n  left: 0 !important;\n}\nbody.mtdeck .old-composer-footer,\nbody.mtdeck .column-nav-flyout {\n  display: none;\n}\nbody.mtdeck .js-search-in-popover .popover {\n  width: 200px !important;\n}\nbody.mtdeck .js-mediaembed .js-media-native-video,\nbody.mtdeck .js-mediaembed .youtube-player {\n  width: 100% !important;\n  position: fixed;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto !important;\n  z-index: 1;\n}\nbody.mtdeck .column-navigator {\n  top: 50px;\n}\nbody.mtdeck .column-nav-link:after {\n  display: none;\n}\nbody.mtdeck div.prf-header-inner-overlay {\n  background-image: linear-gradient(transparent, rgba(20, 23, 26, 0.9));\n}\n\nbody.mtdeck .app-content {\n  will-change: transform;\n}\nbody.mtdeck .app-content.is-open {\n  margin-right: 0 !important;\n  transform: translateX(100%) !important;\n}\nbody.mtdeck .drawer[data-drawer=compose] {\n  left: -100%;\n  width: 100%;\n}\nbody.mtdeck .drawer[data-drawer=accountSettings] {\n  left: calc(-1 * 100vw + 60px);\n  width: calc(100vw - 60px);\n}\nbody.mtdeck button.js-hide-drawer {\n  display: none !important;\n}\n\nbody.mtdeck .js-int-scroller {\n  display: flex;\n  justify-content: space-between;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #1c2938;\n  overflow-x: auto;\n  white-space: nowrap;\n  padding-top: 10px;\n  height: 40px;\n}\nbody.mtdeck .js-int-scroller .column-nav-item {\n  height: 35px;\n}\nbody.mtdeck .js-int-scroller .column-nav-item .icon-medium {\n  font-size: 20px;\n}\nbody.mtdeck .js-int-scroller .column-nav-item .js-header-action {\n  padding-left: 12px !important;\n  padding-right: 12px !important;\n}\nbody.mtdeck .hide-detail-view-inline .js-int-scroller,\nbody.mtdeck .with-nav-border-t:before {\n  display: none;\n}\nbody.mtdeck .column-nav-item {\n  display: inline-block;\n}\n\nbody.mtdeck-close header.app-header {\n  position: relative;\n  top: -50px;\n}\nbody.mtdeck-close div.app-columns-container {\n  left: 0 !important;\n}\n\nhtml.dark .mtdeck-config {\n  background-color: #1c2938;\n}\n\n.mtdeck-config {\n  display: none;\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  z-index: 201;\n  background-color: #fff;\n  padding: 20px;\n}\n.mtdeck-config.is-open {\n  display: block;\n}\n.mtdeck-config-button {\n  color: blueviolet !important;\n}\n.mtdeck-config-item {\n  margin-bottom: 15px !important;\n  /* 設定項目の行間を狭める */\n}\n.mtdeck-config-input[type=number] {\n  width: 80px;\n  margin-right: 10px;\n}\n.mtdeck-config-footer {\n  position: fixed;\n  bottom: 20px;\n}\n\nbody.mtdeck-no-animation,\nbody.mtdeck-no-animation *:not(iframe) {\n  transition-duration: 1ms !important;\n}\n\nbody.mtdeck-hide-images .js-media:not(.detail-preview) {\n  height: 25px !important;\n  border-radius: 0 !important;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-sensitive {\n  height: 1rem;\n  background-color: transparent;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-sensitive::before {\n  content: "[sensitive]";\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-sensitive div {\n  display: none;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container {\n  width: 100% !important;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-item,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-image,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-item,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-image {\n  height: 0;\n  width: max-content;\n  background-image: none !important;\n  border-radius: 0;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-item::before,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-image::before,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-item::before,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-image::before {\n  content: "[media]";\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-item *,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:first-child .media-image *,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-item *,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .js-media-preview-container .media-image * {\n  display: none !important;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:not(:first-child) {\n  display: none !important;\n}\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:not(:first-child) .media-item,\nbody.mtdeck-hide-images .js-media:not(.detail-preview) .media-image-container:not(:first-child) .media-image {\n  background-image: none !important;\n}\nbody.mtdeck-hide-images .item-box-full-bleed .media-item,\nbody.mtdeck-hide-images .item-box-full-bleed .media-image {\n  margin: auto !important;\n}\n\nbody.mtdeck-hide-counts .reply-count, body.mtdeck-hide-counts .retweet-count, body.mtdeck-hide-counts .like-count {\n  display: none;\n}\nbody.mtdeck-hide-counts .app-columns .column-detail .tweet-detail footer .js-tweet-stats {\n  display: none;\n}\n\nbody.mtdeck-lazy-load-image .media-item,\nbody.mtdeck-lazy-load-image .media-image {\n  background-image: none !important;\n}\n\nbody.mtdeck-mobile .item-box {\n  padding: 12px 16px;\n}\nbody.mtdeck-mobile .item-box .item-img {\n  width: 48px;\n}\nbody.mtdeck-mobile .item-box .avatar {\n  width: 48px;\n  height: 48px;\n}\nbody.mtdeck-mobile .item-box .dropdown-menu {\n  width: 90vw;\n  margin-right: -5vw;\n  font-size: 15px;\n}\nbody.mtdeck-mobile .item-box .dropdown-menu .caret {\n  right: 13px;\n}\nbody.mtdeck-mobile .item-box .dropdown-menu [data-action] {\n  padding: 8px 20px;\n}\nbody.mtdeck-mobile .item-box .tweet {\n  padding-left: 60px;\n}\nbody.mtdeck-mobile .item-box .tweet .tweet-header {\n  margin-bottom: 2px;\n}\nbody.mtdeck-mobile .item-box .tweet .tweet-header .tweet-img {\n  margin-left: -60px;\n}\nbody.mtdeck-mobile .item-box .tweet .thread {\n  left: 38px;\n}\nbody.mtdeck-mobile .item-box .tweet .tweet-body .other-replies {\n  margin-bottom: 2px;\n}\nbody.mtdeck-mobile .item-box .tweet .tweet-footer {\n  margin-top: 12px;\n}\nbody.mtdeck-mobile .item-box .tweet .tweet-footer .tweet-actions {\n  display: flex;\n  justify-content: space-between;\n}\nbody.mtdeck-mobile .item-box .tweet .js-show-this-thread > p {\n  margin-top: 12px !important;\n}\nbody.mtdeck-mobile .item-box .tweet-detail.js-has-replies {\n  margin-left: 48px !important;\n}\nbody.mtdeck-mobile .item-box .tweet-detail.js-has-replies .thread {\n  left: 38px;\n}\nbody.mtdeck-mobile .item-box .tweet-detail .account-summary {\n  margin-bottom: 12px !important;\n}\nbody.mtdeck-mobile .item-box .tweet-detail .account-summary .item-img {\n  margin-right: 12px !important;\n}\nbody.mtdeck-mobile .item-box .tweet-detail .account-summary .tweet-text {\n  margin-bottom: 12px !important;\n}\nbody.mtdeck-mobile .item-box .tweet-detail .tweet-detail-actions {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\nbody.mtdeck-mobile .item-box .activity-header {\n  display: flex;\n  align-items: center;\n  margin-top: 0;\n  margin-bottom: 2px;\n}\nbody.mtdeck-mobile .item-box .activity-header .item-img {\n  margin-top: 0 !important;\n}\nbody.mtdeck-mobile .item-box .activity-header i {\n  font-size: 1.3em !important;\n  line-height: 1em;\n}\nbody.mtdeck-mobile .item-box .activity-header i.icon-user-filled {\n  font-size: 1em !important;\n}\nbody.mtdeck-mobile .item-box .activity-header .avatar {\n  width: 30px;\n  height: 30px;\n}\nbody.mtdeck-mobile .item-box .quoted-tweet, body.mtdeck-mobile .item-box .media-preview {\n  margin-top: 12px !important;\n  margin-bottom: 0 !important;\n}\nbody.mtdeck-mobile .item-box video {\n  width: 100%;\n  height: auto;\n}\n\nbody.mtdeck[data-btd-ready=true] .media-size-medium.btd-aspect-ratio-thumbnail,\nbody.mtdeck[data-btd-ready=true] .media-size-large.btd-aspect-ratio-thumbnail {\n  padding-top: calc(var(--btd-thumb-height) / var(--btd-thumb-width) * 100%);\n}\nbody.mtdeck[data-btd-ready=true] .js-int-scroller {\n  background-color: var(--btd-theme-background-lighter);\n}'),window.MTD=new class{constructor(){this.config=new k,this.scrollController=new a,this.backController=new y,this.columnIndex=0,this.$columns=[],this.$drawerOpenButton=null}ready(){const e=setInterval((()=>{this.$drawerOpenButton=document.querySelector("button[data-drawer=compose]"),this.$drawerOpenButton&&(this.config.init(),this.init(),this.scrollController.init(),clearInterval(e))}),100)}update(){this.$columns=[],document.querySelectorAll("section.column").forEach((e=>{this.$columns.push(e)})),this.fixColumnState(),this.updateTweetButton()}fixColumnState(){this.columnIndex=0;let e=this.$columns[0];for(let t=1;t<this.$columns.length;t++)Math.pow(this.$columns[t].getBoundingClientRect().left,2)<Math.pow(e.getBoundingClientRect().left,2)&&(e=this.$columns[t],this.columnIndex=t);e.scrollIntoView()}updateTweetButton(){const e=document.querySelector(".tweet-button");setTimeout((()=>{this.$columns[this.columnIndex].classList.contains("js-column-state-detail-view")?e.style.display="none":e.style.display="block"}),200)}init(){document.body.classList.add("mtdeck"),s.close();const e=document.querySelector("div.app-columns-container");if(this.config.getBoolean("mtdBackAtMounted")&&n(".js-dismiss"),this.config.getBoolean("mtdNoAnimation")&&document.body.classList.add("mtdeck-no-animation"),this.config.getBoolean("mtdHideCounts")&&document.body.classList.add("mtdeck-hide-counts"),this.config.getBoolean("mtdHideImages"))document.body.classList.add("mtdeck-hide-images");else if(this.config.getBoolean("mtdLazyLoadImages")){document.body.classList.add("mtdeck-lazy-load-image");!function(e){const t=new IntersectionObserver((e=>{for(const t of e)if(t.isIntersecting){const e=t.target.style;e.setProperty("background-image",e.backgroundImage,"important")}})),n=new MutationObserver((e=>{for(const n of e)n.addedNodes.forEach((e=>{if("querySelector"in e){const n=e.querySelectorAll(".media-item, .media-image");n&&n.forEach((e=>t.observe(e)))}}))}));e.forEach((e=>{n.observe(e,{childList:!0,attributes:!1,characterData:!1,subtree:!0})}))}([e,document.querySelector("#open-modal")])}this.config.getBoolean("mtdMobileStyleFriendly")&&document.body.classList.add("mtdeck-mobile"),this.config.getBoolean("mtdShowAbsoluteTime")&&document.body.classList.add("mtdeck-show-absolute-time"),this.config.getBoolean("mtdShowExpander")&&document.body.classList.add("mtdeck-show-expander"),this.config.getBoolean("mtdEnableSwipeNavMedia")&&document.body.classList.add("mtdeck-enable-swipe-media"),this.config.getBoolean("mtdEnableSwipeNavCol")&&document.body.classList.add("mtdeck-enable-swipe-col"),this.config.getBoolean("mtdSwipeDownToCloseMedia")&&document.body.classList.add("mtdeck-enable-swipe-down-to-close-media"),this.config.getBoolean("mtdTapToShowFullImage")&&document.body.classList.add("mtdeck-enable-tap-to-show-full-image"),this.config.getBoolean("mtdShowInitialInColumnTab")&&document.body.classList.add("mtdeck-show-initial-in-col-tab"),(new v).doCustomize(this),(new C).doCustomize(),this.update();const t=new w(e);t.onTap=()=>{this.update(),s.close()};const i=this.config.getNumber("mtdMenuOpenRange");t.onSwipeX=(e,t)=>{"right"==t?e<i?s.open():this.backColumn():this.pushColumn()},history.pushState(null,"",null),window.addEventListener("popstate",(e=>this.back())),this.$drawerOpenButton.addEventListener("click",(e=>{s.close()}))}back(){this.update(),this.backController.back(),history.pushState(null,"",null)}pushColumn(){this.update(),s.close(),this.columnIndex<this.$columns.length-1&&(this.columnIndex++,this.scrollController.scrollTo(this.$columns[this.columnIndex]))}backColumn(){this.update(),s.close(),0==this.columnIndex?s.open():(this.columnIndex--,this.scrollController.scrollTo(this.$columns[this.columnIndex]))}},window.MTD.ready()}();
